var apexSignature={parseBoolean:function(e){var n;return"true"==e.toLowerCase()&&(n=!0),"false"==e.toLowerCase()&&(n=!1),"true"!=e.toLowerCase()&&"false"!=e.toLowerCase()&&(n=void 0),n},clob2Array:function(e,n,a){loopCount=Math.floor(e.length/n)+1;for(var o=0;o<loopCount;o++)a.push(e.slice(n*o,n*(o+1)));return a},dataURI2base64:function(e){return e.substr(e.indexOf(",")+1)},save2Db:function(e,n,a,o){var t=apexSignature.dataURI2base64(a),i=[];i=apexSignature.clob2Array(t,3e4,i),apex.server.plugin(e.ajaxIdentifier,{f01:i,pageItems:void 0!==e.ajaxItemsToSubmit?e.ajaxItemsToSubmit.split(","):null},{dataType:"html",success:function(e){$("#"+n).trigger("apexsignature-saved-db",JSON.parse(e||"{}")),o()},error:function(e,a){$("#"+n).trigger("apexsignature-error-db"),console.log("save2Db: apex.server.plugin ERROR:",a),o()}})},apexSignatureFnc:function(e,n,a){var o=n,t=document.getElementById(o.canvasId),i=apexSignature.parseBoolean(a),r=parseInt(o.lineMinWidth),l=parseInt(o.lineMaxWidth),s=o.clearButton,c=o.saveButton,g=o.emptyAlert,p=apexSignature.parseBoolean(o.showSpinner),u=t.width,v=t.height,x=parseInt(document.documentElement.clientWidth),d=parseInt(document.documentElement.clientHeight),m=apexSignature.parseBoolean(o.trimCanvas),S=o.imageFormat,h="image/jpeg"==S?o.backgroundColor.replace("rgba","rgb").replace(/,(\d+(\.\d+)?\))$/,")"):o.backgroundColor;i&&(console.log("apexSignatureFnc: vOptions.ajaxIdentifier:",o.ajaxIdentifier),console.log("apexSignatureFnc: vOptions.ajaxItemsToSubmit:",o.ajaxItemsToSubmit),console.log("apexSignatureFnc: vOptions.canvasId:",o.canvasId),console.log("apexSignatureFnc: vOptions.lineMinWidth:",o.lineMinWidth),console.log("apexSignatureFnc: vOptions.lineMaxWidth:",o.lineMaxWidth),console.log("apexSignatureFnc: vOptions.backgroundColor:",h),console.log("apexSignatureFnc: vOptions.penColor:",o.penColor),console.log("apexSignatureFnc: vOptions.saveButton:",o.saveButton),console.log("apexSignatureFnc: vOptions.clearButton:",o.clearButton),console.log("apexSignatureFnc: vOptions.emptyAlert:",o.emptyAlert),console.log("apexSignatureFnc: vOptions.showSpinner:",o.showSpinner),console.log("apexSignatureFnc: pRegionId:",e),console.log("apexSignatureFnc: vCanvasWidth:",u),console.log("apexSignatureFnc: vCanvasHeight:",v),console.log("apexSignatureFnc: vClientWidth:",x),console.log("apexSignatureFnc: vCientHeight:",v),console.log("apexSignatureFnc: vTrimCanvas:",m),console.log("apexSignatureFnc: vImageFormat:",S)),u>x&&(t.width=x-60),v>d&&(t.height=d-60);var f=new SignaturePad(t,{minWidth:r,maxWidth:l,backgroundColor:h,penColor:o.penColor});$(s).click((function(){f.clear(),$("#"+e).trigger("apexsignature-cleared")})),$(c).click((function(){if(!1===f.isEmpty()){if(p)var n=apex.util.showSpinner($("#"+e));var a;a=m?"image/jpeg"==S?f.trimWhitespace(S):f.trimWhitespace():"image/jpeg"==S?f.toDataURL(S):f.toDataURL(),apexSignature.save2Db(o,e,a,(function(){f.clear(),p&&n.remove()}))}else alert(g)}))}};